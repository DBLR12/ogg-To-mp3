# 🎵 OGG转音频格式转换工具

一个现代化的图形界面音频格式转换工具，专门用于将OGG格式文件批量转换为WAV或MP3格式。

## ✨ 主要特性

### 🚀 核心功能
- **批量转换**: 支持单个文件或整个文件夹的批量处理
- **递归搜索**: 自动搜索文件夹及其所有子文件夹中的OGG文件  
- **智能输出**: 为每个文件创建独立的输出文件夹，避免文件冲突
- **格式自适应**: 根据系统环境自动选择最佳转换方案

### 🎨 用户界面
- **拖拽上传**: 支持直接拖拽文件或文件夹到程序窗口
- **实时预览**: 转换前预览所有待处理的文件列表
- **进度显示**: 实时显示转换进度和当前处理状态
- **状态反馈**: 智能错误处理和详细状态提示

### 🔧 技术特点
- **无FFmpeg依赖**: 推荐方案无需安装FFmpeg，使用纯Python实现
- **多重备用**: 支持多种音频处理库，自动选择最佳可用方案
- **高质量转换**: 保持原始音频的采样率和音质
- **跨平台兼容**: 支持Windows系统，易于扩展到其他平台

## 📋 系统要求

- **操作系统**: Windows 10/11
- **Python版本**: Python 3.7 或更高版本
- **磁盘空间**: 约100MB（包含依赖库）
- **内存**: 建议512MB可用内存

## 🚀 快速开始

### 方法一：一键安装（推荐）

1. **轻量级版本**（无需FFmpeg，推荐）:
   ```bash
   双击运行 install_lightweight.bat
   ```

2. **完整版本**（包含FFmpeg支持）:
   ```bash
   # 1.安装FFmpeg
   winget install ffmpeg
   # 2.下载依赖以及运行程序
   install_and_run.bat
   ```

### 方法二：手动安装

1. **安装Python依赖**:
   ```bash
   # 轻量级版本（推荐）
   pip install -r requirements_lightweight.txt
   
   # 或使用国内镜像源（更快）
   pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements_lightweight.txt
   ```

2. **运行程序**:
   ```bash
   python ogg_to_mp3_converter.py
   ```

## 🎯 使用指南

### 基本操作流程

1. **启动程序**
   - 双击运行安装脚本，或手动运行Python程序

2. **选择输入文件**
   - **方法一**: 直接拖拽OGG文件或包含OGG文件的文件夹到程序窗口
   - **方法二**: 点击"选择文件"或"选择文件夹"按钮手动选择

3. **预览文件列表**
   - 程序会自动扫描并显示所有找到的OGG文件
   - 支持递归搜索，会找到所有子文件夹中的OGG文件

4. **选择输出位置**
   - 点击"选择输出文件夹"选择转换后文件的保存位置

5. **开始转换**
   - 点击窗口底部的"🚀 开始转换"按钮
   - 实时查看转换进度和状态

6. **查看结果**
   - 转换完成后查看成功和失败的文件统计
   - 在输出文件夹中找到转换后的文件

### 输出文件结构

程序会为每个音频文件创建独立的文件夹：

```
输出文件夹/
├── 歌曲一/
│   └── 歌曲一.wav (或 歌曲一.mp3)
├── 歌曲二/
│   └── 歌曲二.wav (或 歌曲二.mp3)
└── 歌曲三/
    └── 歌曲三.wav (或 歌曲三.mp3)
```

### 转换格式说明

| 转换方案 | 输出格式 | 音质 | 依赖要求 | 推荐指数 |
|----------|----------|------|----------|----------|
| **librosa方案** | WAV | 无损 | 无需FFmpeg | ⭐⭐⭐⭐⭐ |
| pydub方案 | MP3 | 高质量 | 需要FFmpeg | ⭐⭐⭐⭐ |

## 🔧 技术详解

### 音频转换技术

#### WAV转换（推荐方案）
- **技术栈**: librosa + soundfile
- **转换原理**: 完整解码OGG → 重新编码为WAV
- **音质**: 100%无损，PCM格式存储
- **兼容性**: 所有音频播放器都支持
- **优势**: 无需外部依赖，安装简单，转换稳定

#### MP3转换（可选方案）  
- **技术栈**: pydub + FFmpeg
- **转换原理**: OGG解码 → MP3重编码
- **音质**: 192kbps高质量MP3
- **文件大小**: 比WAV小很多
- **要求**: 需要安装FFmpeg

### 转换质量保证

#### 真实格式转换验证
我们的转换是**真正的格式转换**，不是简单的文件重命名：

- ✅ **文件大小变化**: WAV文件通常比OGG大20-30倍
- ✅ **文件格式头**: OGG(`OggS`) → WAV(`RIFF`)完全不同
- ✅ **编码方式**: Vorbis有损 → PCM无损，完全重新编码
- ✅ **音频质量**: 保持原始采样率和音频参数

#### 质量参数
- **采样率**: 保持原始采样率（通常44.1kHz或48kHz）
- **位深度**: 16-bit PCM（WAV）或192kbps（MP3）
- **声道**: 保持原始单声道/立体声设置
- **动态范围**: 完整保留原始音频的动态范围

## 🛠 安装选项详解

### 轻量级安装（推荐）

```bash
# 核心依赖
customtkinter==5.2.2    # 现代化GUI框架
tkinterdnd2==0.3.0       # 拖拽支持
librosa>=0.10.0          # 音频处理
soundfile>=0.12.0        # 音频文件I/O
numpy>=1.21.0            # 数值计算
```

**优势**:
- ✅ 无需FFmpeg，纯Python实现
- ✅ 安装简单，依赖少
- ✅ 国内下载速度快
- ✅ 无损音质输出
- ✅ 跨平台兼容性好

### 完整安装（可选）

在轻量级安装基础上额外安装：
```bash
pydub==0.25.1           # 音频处理库
# + FFmpeg (需要手动安装)
```

**适用场景**:
- 需要MP3格式输出
- 需要更多音频格式支持
- 对文件大小有要求

## ⚠️ 常见问题解答

### 安装相关

**Q: 提示"缺少音频处理库"？**  
A: 运行 `install_lightweight.bat` 自动安装所有依赖

**Q: 安装速度慢？**  
A: 使用国内镜像源：
```bash
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple [包名]
```

**Q: Python版本问题？**  
A: 确保使用Python 3.7+，推荐Python 3.8-3.11

### 使用相关

**Q: 转换后是WAV格式，我想要MP3？**  
A: 安装FFmpeg后程序会自动切换到MP3输出：
```bash
winget install ffmpeg
```

**Q: 转换失败怎么办？**  
A: 检查以下项目：
- 确保OGG文件未损坏
- 确保有足够的磁盘空间
- 确保输出文件夹有写入权限
- 查看错误信息中的具体原因

**Q: 找不到转换按钮？**  
A: 转换按钮位于窗口底部，如果被遮挡请：
- 尝试滚动界面内容
- 调整窗口大小
- 重新启动程序

**Q: 转换速度慢？**  
A: 转换速度取决于：
- 文件大小和数量
- 计算机性能
- 磁盘I/O速度
通常每秒可处理几个文件

### 技术相关

**Q: WAV文件很大，正常吗？**  
A: 是的，WAV是无损格式：
- OGG: 有损压缩，文件较小
- WAV: 无损存储，文件较大（通常大20-30倍）
- 这证明了真正的格式转换

**Q: 音质有损失吗？**  
A: WAV转换是无损的：
- 保持原始采样率和位深度
- 完整保留音频数据
- 音质等同于或优于原始OGG

## 📦 项目文件说明

```
ogg转mp3/
├── ogg_to_mp3_converter.py      # 主程序文件
├── install_lightweight.bat      # 轻量级一键安装脚本（推荐）
├── install_and_run.bat         # 完整版安装脚本
├── requirements_lightweight.txt # 轻量级依赖列表
├── requirements.txt            # 完整依赖列表
└── README.md                   # 项目说明文档
```

### 批处理脚本示例
```batch
@echo off
echo 批量转换OGG文件...
python ogg_to_mp3_converter.py
echo 转换完成！
pause
```

## 📄 许可证

本项目采用MIT许可证，详见 [LICENSE](LICENSE) 文件。

## 🙏 致谢

- [CustomTkinter](https://github.com/TomSchimansky/CustomTkinter) - 现代化GUI框架
- [librosa](https://librosa.org/) - 专业音频处理库
- [soundfile](https://github.com/bastibe/python-soundfile) - 音频文件I/O
- [pydub](https://github.com/jiaaro/pydub) - 简单音频处理

- [tkinterdnd2](https://github.com/pmgagne/tkinterdnd2) - 拖拽支持
